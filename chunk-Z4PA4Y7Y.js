import{c as E}from"./chunk-CBZEXOLU.js";import{a as y,b as x}from"./chunk-ORAH6THI.js";import{b as V}from"./chunk-FDNP3USR.js";import{a as S,d as s,k as c}from"./chunk-EFI6HIJC.js";import{d as O}from"./chunk-4CWSLAMQ.js";import{E as v}from"./chunk-VAHVCNLV.js";import{o as b}from"./chunk-LU62OM3R.js";import{Ca as C,Cb as w,Ma as f,Ob as L,Qb as A,Tc as h,Uc as l,Zb as R,ga as u,ia as g,ta as m,ua as _,vc as M}from"./chunk-KVLKPACU.js";var i=function(e){return e.at_least_eight_chars="minChar",e.at_least_one_lower_case_char="lowerCase",e.at_least_one_upper_case_char="upperCase",e.at_least_one_digit_char="digit",e.at_least_one_special_char=" specialChar",e.at_custom_chars="customChars",e}(i||{});var p=class{isUndefinedOrEmpty(o){!o||!o.value||o.value.length}validate(o,t){return a=>{if(this.isUndefinedOrEmpty(a),!t.test(a.value)){let d={};return d[o]={actualValue:a.value,requiredPattern:t},d}}}confirm(o){return r=>{if(this.isUndefinedOrEmpty(r),r.value!==o)return{notConfirmed:{password:o,passwordConfirmation:r.value}}}}};var n={lowerCase:RegExp(/^(?=.*?[a-z])/),upperCase:RegExp(/^(?=.*?[A-Z])/),digit:RegExp(/^(?=.*?[0-9])/),specialChar:RegExp(/^(?=.*?[" !"#$%&'()*+,-./:;<=>?@[\]^_`{|}~"])/)};var G=(()=>{class e{constructor(){this.enableLengthRule=!0,this.enableLowerCaseLetterRule=!0,this.enableUpperCaseLetterRule=!0,this.enableDigitRule=!0,this.enableSpecialCharRule=!0,this.min=8,this.max=30,this.warnThreshold=21,this.accentThreshold=81,this.onStrengthChanged=new f,this.criteriaMap=new Map,this.passwordFormControl=new c,this.passwordConfirmationFormControl=new c,this.validatorsArray=[],this.passwordStrengthValidator=new p,this._strength=0,this.propagateChange=t=>{}}get strength(){return this._strength?this._strength:0}get isLow(){return this.strength===20}get isWeak(){return this.strength===40}get isMedium(){return this.strength===60}get isStrong(){return this.strength===80}get isVeryStrong(){return this.strength===100}ngOnInit(){this.setRulesAndValidators()}ngOnChanges(t){if(!(t.externalError&&t.externalError.firstChange||t.password&&t.password.firstChange)){if(t.externalError&&t.externalError.currentValue)return;t.password&&t.password.previousValue===t.password.currentValue&&!t.password.firstChange?this.calculatePasswordStrength():this.password&&this.password.length>0?this.calculatePasswordStrength():this.reset()}}parseCustomValidatorsRegex(t=this.customValidator){if(t instanceof RegExp)return this.customValidator;if(t==="string")return RegExp(this.customValidator);throw new Error("")}setRulesAndValidators(){this.validatorsArray=[],this.criteriaMap=new Map,this.passwordConfirmationFormControl.setValidators(s.compose([s.required,this.passwordStrengthValidator.confirm(this.password)])),this.validatorsArray.push(s.required),this.enableLengthRule&&(this.criteriaMap.set(i.at_least_eight_chars,RegExp(`^.{${this.min},${this.max}}$`)),this.validatorsArray.push(s.minLength(this.min)),this.validatorsArray.push(s.maxLength(this.max))),this.enableLowerCaseLetterRule&&(this.criteriaMap.set(i.at_least_one_lower_case_char,n.lowerCase),this.validatorsArray.push(s.pattern(n.lowerCase))),this.enableUpperCaseLetterRule&&(this.criteriaMap.set(i.at_least_one_upper_case_char,n.upperCase),this.validatorsArray.push(s.pattern(n.upperCase))),this.enableDigitRule&&(this.criteriaMap.set(i.at_least_one_digit_char,n.digit),this.validatorsArray.push(s.pattern(n.digit))),this.enableSpecialCharRule&&(this.criteriaMap.set(i.at_least_one_special_char,n.specialChar),this.validatorsArray.push(s.pattern(n.specialChar))),this.customValidator&&(this.criteriaMap.set(i.at_custom_chars,this.parseCustomValidatorsRegex()),this.validatorsArray.push(s.pattern(this.parseCustomValidatorsRegex()))),this.criteriaMap.forEach((t,r)=>{this.validatorsArray.push(this.passwordStrengthValidator.validate(r,t))}),this.passwordFormControl.setValidators(s.compose([...this.validatorsArray])),this.Validators=s.compose([...this.validatorsArray])}calculatePasswordStrength(){let t=[],r=100/this.criteriaMap.size;t.push(this.enableLengthRule?this._containAtLeastMinChars():!1,this.enableLowerCaseLetterRule?this._containAtLeastOneLowerCaseLetter():!1,this.enableUpperCaseLetterRule?this._containAtLeastOneUpperCaseLetter():!1,this.enableDigitRule?this._containAtLeastOneDigit():!1,this.enableSpecialCharRule?this._containAtLeastOneSpecialChar():!1,this.customValidator?this._containCustomChars():!1),this._strength=t.filter(a=>a).length*r,this.propagateChange(this.strength),this.onStrengthChanged.emit(this.strength),this.setRulesAndValidators()}reset(){this._strength=0,this.containAtLeastMinChars=!1,this.containAtLeastOneLowerCaseLetter=!1,this.containAtLeastOneUpperCaseLetter=!1,this.containAtLeastOneDigit=!1,this.containAtCustomChars=!1,this.containAtLeastOneSpecialChar=!1}writeValue(t){t&&(this._strength=t)}registerOnChange(t){this.propagateChange=t}registerOnTouched(t){}setDisabledState(t){}_containAtLeastMinChars(){return this.containAtLeastMinChars=this.password.length>=this.min,this.containAtLeastMinChars}_containAtLeastOneLowerCaseLetter(){return this.containAtLeastOneLowerCaseLetter=this.criteriaMap.get(i.at_least_one_lower_case_char).test(this.password),this.containAtLeastOneLowerCaseLetter}_containAtLeastOneUpperCaseLetter(){return this.containAtLeastOneUpperCaseLetter=this.criteriaMap.get(i.at_least_one_upper_case_char).test(this.password),this.containAtLeastOneUpperCaseLetter}_containAtLeastOneDigit(){return this.containAtLeastOneDigit=this.criteriaMap.get(i.at_least_one_digit_char).test(this.password),this.containAtLeastOneDigit}_containAtLeastOneSpecialChar(){return this.containAtLeastOneSpecialChar=this.criteriaMap.get(i.at_least_one_special_char).test(this.password),this.containAtLeastOneSpecialChar}_containCustomChars(){return this.containAtCustomChars=this.criteriaMap.get(i.at_custom_chars).test(this.password),this.containAtCustomChars}ngAfterContentChecked(){this.password&&this.calculatePasswordStrength()}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275cmp=m({type:e,selectors:[["emr-password-strength"]],hostVars:10,hostBindings:function(r,a){r&2&&A("low",a.isLow)("weak",a.isWeak)("medium",a.isMedium)("strong",a.isStrong)("very-strong",a.isVeryStrong)},inputs:{password:"password",externalError:[2,"externalError","externalError",h],enableLengthRule:[2,"enableLengthRule","enableLengthRule",h],enableLowerCaseLetterRule:[2,"enableLowerCaseLetterRule","enableLowerCaseLetterRule",h],enableUpperCaseLetterRule:[2,"enableUpperCaseLetterRule","enableUpperCaseLetterRule",h],enableDigitRule:[2,"enableDigitRule","enableDigitRule",h],enableSpecialCharRule:[2,"enableSpecialCharRule","enableSpecialCharRule",h],min:[2,"min","min",l],max:[2,"max","max",l],customValidator:"customValidator",warnThreshold:[2,"warnThreshold","warnThreshold",l],accentThreshold:[2,"accentThreshold","accentThreshold",l]},outputs:{onStrengthChanged:"onStrengthChanged"},exportAs:["emrPasswordStrength"],features:[M([{provide:S,useExisting:u(()=>e),multi:!0}]),w,C],decls:1,vars:1,consts:[["mode","determinate",3,"value"]],template:function(r,a){r&1&&R(0,"mat-progress-bar",0),r&2&&L("value",a.strength)},dependencies:[y],styles:["[_nghost-%COMP%]{margin-top:.25rem;display:block;--mdc-linear-progress-track-height: .5rem;--mdc-linear-progress-active-indicator-height: .5rem}[_nghost-%COMP%]     .mdc-linear-progress__bar-inner{--mdc-linear-progress-active-indicator-color: transparent}.low[_nghost-%COMP%]     .mdc-linear-progress__bar-inner{--mdc-linear-progress-active-indicator-color: #f87171}.weak[_nghost-%COMP%]     .mdc-linear-progress__bar-inner{--mdc-linear-progress-active-indicator-color: #fbbf24}.medium[_nghost-%COMP%]     .mdc-linear-progress__bar-inner{--mdc-linear-progress-active-indicator-color: #22c55e}.strong[_nghost-%COMP%]     .mdc-linear-progress__bar-inner{--mdc-linear-progress-active-indicator-color: #22c55e}.very-strong[_nghost-%COMP%]     .mdc-linear-progress__bar-inner{--mdc-linear-progress-active-indicator-color: #22c55e}"],changeDetection:0})}}return e})();var tt=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=_({type:e})}static{this.\u0275inj=g({imports:[b,x,O,E,V,v]})}}return e})();export{G as a,tt as b};
